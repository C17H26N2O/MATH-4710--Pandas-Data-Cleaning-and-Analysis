<!DOCTYPE html>
<html>
<head>
<title>è§†é¢‘æ–‡æ¡ˆ(åŒ…å«ä»£ç )(åªçœ‹è¿™ä¸ªå°±å¤Ÿäº†ğŸ˜‹).md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="pandas%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E4%B8%8E%E5%88%86%E6%9E%90%E5%AE%8C%E6%95%B4%E6%BC%94%E8%AE%B2%E7%A8%BF%E4%B8%AD%E6%96%87%E7%89%88">Pandas:æ•°æ®æ¸…æ´—ä¸åˆ†æå®Œæ•´æ¼”è®²ç¨¿ï¼ˆä¸­æ–‡ç‰ˆï¼‰</h1>
<hr>
<h2 id="%E8%A7%86%E9%A2%91%E5%BC%80%E5%9C%BA"><strong>è§†é¢‘å¼€åœº</strong></h2>
<p><strong>(0:00 - 0:30)</strong></p>
<p>å¤§å®¶å¥½,æ¬¢è¿æ¥åˆ°ä»Šå¤©çš„è¯¾ç¨‹ã€‚æˆ‘æ˜¯ Yihanã€‚åœ¨æ¥ä¸‹æ¥çš„å¤§çº¦45åˆ†é’Ÿé‡Œ,æˆ‘ä»¬å°†ä¸€èµ·æ¢ç´¢å¦‚ä½•ä½¿ç”¨Pandasè¿™ä¸ªå¼ºå¤§çš„Pythonåº“,å°†æ··ä¹±ã€åˆ†æ•£çš„æ•°æ®å˜å¾—äº•äº•æœ‰æ¡,å¹¶ä»ä¸­æå–å‡ºæœ‰ä»·å€¼çš„å•†ä¸šæ´å¯Ÿã€‚æ— è®ºæ‚¨æ˜¯æ•°æ®åˆ†æé¢†åŸŸçš„æ–°æ‰‹,è¿˜æ˜¯å¸Œæœ›ç³»ç»Ÿæ¢³ç†Pandasæ ¸å¿ƒæŠ€èƒ½çš„å¼€å‘è€…,æœ¬è¯¾ç¨‹éƒ½å°†ä¸ºæ‚¨æ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚</p>
<hr>
<h2 id="%E7%AC%AC%E4%B8%80%E8%8A%82%E5%BC%95%E8%A8%80%E4%B8%8E%E6%83%85%E6%99%AF%E8%AE%BE%E5%AE%9A"><strong>ç¬¬ä¸€èŠ‚:å¼•è¨€ä¸æƒ…æ™¯è®¾å®š</strong></h2>
<p><strong>(0:30 - 3:30)</strong></p>
<p>æˆ‘ä»¬å…ˆä¸æ€¥ç€è®²ä»£ç ã€‚æƒ³è±¡ä¸€ä¸‹è¿™ä¸ªåœºæ™¯:æ‚¨æ˜¯ä¸€å®¶å…¨çƒç”µå•†å…¬å¸æ–°ä¸Šä»»çš„æ•°æ®åˆ†æå¸ˆã€‚ä¸Šç­ç¬¬ä¸€å¤©,æ‚¨çš„è€æ¿å°±äº¤ç»™æ‚¨ä¸€ä¸ªä»»åŠ¡:&quot;æˆ‘ä»¬çš„æ¬§æ´²å¸‚åœº,å“ªä¸ªäº§å“ç±»åˆ«çš„å®é™…é”€å”®é¢æœ€é«˜?æ³¨æ„,è¦æ’é™¤é‚£äº›å·²é€€è´§å’Œå·²å–æ¶ˆçš„è®¢å•ã€‚&quot;</p>
<p>æ‚¨æ‹¿åˆ°äº†æ•°æ®,ä½†æƒ…å†µå¹¶ä¸ç†æƒ³ã€‚æ•°æ®åˆ†æ•£åœ¨ä¸‰ä¸ªä¸åŒçš„æ–‡ä»¶é‡Œ:ä¸€ä¸ªè®°å½•äº¤æ˜“çš„CSVæ–‡ä»¶,ä¸€ä¸ªåŒ…å«å®¢æˆ·ä¿¡æ¯çš„JSONæ–‡ä»¶,è¿˜æœ‰ä¸€ä¸ªå­˜å‚¨äº§å“è¯¦æƒ…çš„Excelè¡¨æ ¼ã€‚æ›´ç³Ÿç³•çš„æ˜¯,è¿™äº›æ•°æ®é‡Œæœ‰å¾ˆå¤šç¼ºå¤±å€¼ã€æ ¼å¼ä¸ä¸€è‡´çš„é—®é¢˜,è€Œä¸”æœ€å…³é”®çš„æ˜¯â€”â€”é”€å”®é¢è¿™ä¸ªå­—æ®µç«Ÿç„¶ä¸å­˜åœ¨!æ‚¨éœ€è¦è‡ªå·±æ ¹æ®æ•°é‡ã€å•ä»·å’ŒæŠ˜æ‰£æ¥è®¡ç®—ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜,æˆ‘ä»¬å°†éµå¾ªä¸€ä¸ªæ¸…æ™°çš„ä¸ƒæ­¥åˆ†ææµç¨‹ã€‚
é¦–å…ˆ,æˆ‘ä»¬ä¼š<strong>åŠ è½½</strong>è¿™äº›ä¸åŒæ ¼å¼çš„æ•°æ®æ–‡ä»¶ã€‚
ç¬¬äºŒæ­¥,<strong>æ£€è§†</strong>æ•°æ®ç»“æ„,äº†è§£æˆ‘ä»¬æ‰‹ä¸Šæœ‰ä»€ä¹ˆã€‚
ç¬¬ä¸‰,<strong>æ¸…ç†</strong>æ•°æ®ä¸­çš„ç¼ºå¤±ä¿¡æ¯å’Œæ ¼å¼é—®é¢˜ã€‚
ç¬¬å››,è¿›è¡Œ<strong>ç‰¹å¾å·¥ç¨‹</strong>,è®¡ç®—å‡ºé”€å”®é¢è¿™ä¸ªå…³é”®æŒ‡æ ‡ã€‚
ç¬¬äº”,<strong>ç­›é€‰</strong>å‡ºæˆ‘ä»¬åªå…³å¿ƒçš„æœ‰æ•ˆæ¬§æ´²å¸‚åœºæ•°æ®ã€‚
ç¬¬å…­,<strong>æ’åº</strong>æ•°æ®,å‘ç°å…³é”®è¶‹åŠ¿ã€‚
ç¬¬ä¸ƒ,æˆ‘ä»¬ä¼š<strong>åˆå¹¶</strong>è¿™ä¸‰ä¸ªç‹¬ç«‹çš„æ–‡ä»¶,æ„å»ºä¸€ä¸ªç»Ÿä¸€ã€å®Œæ•´çš„æ•°æ®é›†ã€‚
æœ€å,ä¹Ÿæ˜¯æœ€å…³é”®çš„ä¸€æ­¥,æˆ‘ä»¬å°†å¯¹è¿™ä»½å¹²å‡€çš„æ•°æ®è¿›è¡Œ<strong>åˆ†ç»„ä¸èšåˆ</strong>,ä»è€Œç²¾å‡†åœ°å›ç­”è€æ¿çš„é—®é¢˜ã€‚</p>
<hr>
<h2 id="%E7%AC%AC%E4%BA%8C%E8%8A%82%E6%A8%A1%E5%9D%97%E4%B8%80---%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B8%8E%E6%A3%80%E8%A7%86"><strong>ç¬¬äºŒèŠ‚:æ¨¡å—ä¸€ - æ•°æ®åŠ è½½ä¸æ£€è§†</strong></h2>
<p><strong>(3:30 - 10:00)</strong></p>
<p>å¥½äº†,è®©æˆ‘ä»¬å¼€å§‹åŠ¨æ‰‹å§ã€‚çœŸå®ä¸–ç•Œçš„æ•°æ®ä»¥å¤šç§æ ¼å¼å­˜åœ¨,è€ŒPandasçš„ç¬¬ä¸€é¡¹è¶…èƒ½åŠ›,å°±æ˜¯èƒ½å°†è¿™äº›ä¸åŒæ ¼å¼çš„æ–‡ä»¶,ç»Ÿä¸€è½¬æ¢æˆä¸€ç§å«åš&quot;æ•°æ®å¸§&quot;(DataFrame)çš„äºŒç»´è¡¨æ ¼ç»“æ„ã€‚è¿™å°±åƒä¸€ä¸ªé€šç”¨çš„æ•°æ®ç¿»è¯‘å™¨ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥åŠ è½½ç¬¬ä¸€ä¸ªæ–‡ä»¶,CSVæ ¼å¼çš„é”€å”®è®°å½•ã€‚æˆ‘ä»¬ä¼šä½¿ç”¨ <code>pd.read_csv()</code> å‡½æ•°ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-comment"># åŠ è½½é”€å”®è®°å½•</span>
sales_df = pd.read_csv(<span class="hljs-string">'sales_records.csv'</span>)
</div></code></pre>
<p>CSVä»£è¡¨&quot;é€—å·åˆ†éš”å€¼&quot;,æ˜¯æœ€å¸¸è§çš„æ•°æ®æ ¼å¼ä¹‹ä¸€ã€‚è¿™ä¸ªå‡½æ•°éå¸¸å¼ºå¤§,å®ƒæœ‰å¾ˆå¤šå¯é€‰å‚æ•°,æ¯”å¦‚ <code>sep</code> å¯ä»¥ç”¨æ¥æŒ‡å®šä¸åŒçš„åˆ†éš”ç¬¦,<code>usecols</code> å¯ä»¥åœ¨åŠ è½½æ—¶åªé€‰æ‹©æˆ‘ä»¬éœ€è¦çš„åˆ—,è¿™åœ¨å¤„ç†å¤§æ–‡ä»¶æ—¶èƒ½æœ‰æ•ˆèŠ‚çœå†…å­˜ã€‚</p>
<p>æ¥ä¸‹æ¥,æˆ‘ä»¬ç”¨ <code>pd.read_excel()</code> æ¥åŠ è½½äº§å“ä¿¡æ¯ã€‚Excelæ–‡ä»¶å¸¸å¸¸åŒ…å«å¤šä¸ªå·¥ä½œè¡¨(sheets),æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨ <code>sheet_name</code> å‚æ•°æ¥æŒ‡å®šè¯»å–å“ªä¸€ä¸ªã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># åŠ è½½äº§å“ä¿¡æ¯</span>
product_df = pd.read_excel(<span class="hljs-string">'product_info.xlsx'</span>, sheet_name=<span class="hljs-string">'ProductDetails'</span>)
</div></code></pre>
<p>æœ€å,æˆ‘ä»¬ç”¨ <code>pd.read_json()</code> æ¥åŠ è½½å®¢æˆ·æ•°æ®ã€‚JSONæ˜¯ä¸€ç§å¸¸ç”¨äºWeb APIçš„é”®å€¼å¯¹æ ¼å¼ã€‚Pandasç”šè‡³å¯ä»¥ç›´æ¥ä»ä¸€ä¸ªURLåŠ è½½JSONæ•°æ®ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># åŠ è½½å®¢æˆ·ä¿¡æ¯</span>
customer_df = pd.read_json(<span class="hljs-string">'customer_details.json'</span>)
</div></code></pre>
<p>æ•°æ®åŠ è½½è¿›æ¥äº†,ä½†æˆ‘ä»¬ç»ä¸èƒ½ç›²ç›®ç›¸ä¿¡å®ƒã€‚ä¸“ä¸šçš„æ•°æ®åˆ†æå¸ˆæ€»ä¼šå…ˆç»™æ•°æ®åšä¸€ä¸ªå¿«é€Ÿçš„&quot;ä½“æ£€&quot;ã€‚æˆ‘ä»¬ä¼šç”¨ä¸‰ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•:<code>.head()</code>ã€<code>.info()</code> å’Œ <code>.describe()</code>ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># é¢„è§ˆé”€å”®æ•°æ®çš„å‰å‡ è¡Œ</span>
print(<span class="hljs-string">"Sales Data Head:"</span>)
print(sales_df.head())

<span class="hljs-comment"># æŸ¥çœ‹æ•°æ®ç»“æ„å’Œç±»å‹ä¿¡æ¯</span>
print(<span class="hljs-string">"\nSales Data Info:"</span>)
sales_df.info()

<span class="hljs-comment"># æŸ¥çœ‹æ•°å€¼åˆ—çš„ç»Ÿè®¡æ‘˜è¦</span>
print(<span class="hljs-string">"\nSales Data Statistics:"</span>)
print(sales_df.describe())
</div></code></pre>
<p><code>.head()</code> å¯ä»¥è®©æˆ‘ä»¬é¢„è§ˆæ•°æ®çš„å‰å‡ è¡Œã€‚è€Œ <code>.info()</code> åˆ™æ›´åŠ é‡è¦,å®ƒä¼šå‘Šè¯‰æˆ‘ä»¬æ¯ä¸€åˆ—çš„æ•°æ®ç±»å‹,ä»¥åŠâ€”â€”è¯·æ³¨æ„çœ‹è¿™é‡Œâ€”â€”éç©ºå€¼çš„æ•°é‡ã€‚é€šè¿‡å¯¹æ¯”æ€»è¡Œæ•°å’Œéç©ºå€¼æ•°,æˆ‘ä»¬ç«‹åˆ»å°±èƒ½å‘ç°å“ªäº›åˆ—å­˜åœ¨ç¼ºå¤±å€¼ã€‚æ‚¨çœ‹,æˆ‘ä»¬çš„æ•°æ®æœ‰150è¡Œ,ä½† <code>discount</code> åˆ—åªæœ‰90ä¸ªéç©ºå€¼,<code>list_price</code> åˆ—æœ‰18ä¸ªç¼ºå¤±å€¼,<code>region</code> åˆ—ä¹Ÿæœ‰3ä¸ªç¼ºå¤±å€¼ã€‚è¿™äº›å°±æ˜¯æˆ‘ä»¬ä¸‹ä¸€æ­¥è¦è§£å†³çš„é—®é¢˜ã€‚</p>
<hr>
<h2 id="%E7%AC%AC%E4%B8%89%E8%8A%82%E6%A8%A1%E5%9D%97%E4%BA%8C---%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC"><strong>ç¬¬ä¸‰èŠ‚:æ¨¡å—äºŒ - å¤„ç†ç¼ºå¤±å€¼</strong></h2>
<p><strong>(10:00 - 20:00)</strong></p>
<p>æ•°æ®æ¸…æ´—æ˜¯æ•°æ®åˆ†æä¸­æœ€è€—æ—¶ä½†ä¹Ÿæœ€å…³é”®çš„ç¯èŠ‚ã€‚ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®åˆ†æå¸ˆä¼šå‘Šè¯‰æ‚¨,ä»–ä»¬80%çš„æ—¶é—´éƒ½èŠ±åœ¨äº†æ¸…æ´—æ•°æ®ä¸Šã€‚ä¸ºä»€ä¹ˆ?å› ä¸ºè„æ•°æ®ä¼šå¯¼è‡´é”™è¯¯çš„ç»“è®º,è¿›è€Œå¯¼è‡´é”™è¯¯çš„å•†ä¸šå†³ç­–ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆæ¥ç»Ÿè®¡ä¸€ä¸‹æ¯åˆ—æœ‰å¤šå°‘ç¼ºå¤±æ•°æ®ã€‚Pandasç”¨ <code>NaN</code>(Not a Number)æ¥è¡¨ç¤ºç¼ºå¤±å€¼ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># ç»Ÿè®¡æ¯åˆ—çš„ç¼ºå¤±å€¼æ•°é‡</span>
print(<span class="hljs-string">"Missing values per column:"</span>)
print(sales_df.isna().sum())

<span class="hljs-comment"># ä¹Ÿå¯ä»¥çœ‹ç¼ºå¤±å€¼çš„ç™¾åˆ†æ¯”</span>
print(<span class="hljs-string">"\nMissing value percentage:"</span>)
print((sales_df.isna().sum() / len(sales_df) * <span class="hljs-number">100</span>).round(<span class="hljs-number">2</span>))
</div></code></pre>
<p>å¥½çš„,ç°åœ¨æˆ‘ä»¬æ¸…æ¥šåœ°çœ‹åˆ°äº†é—®é¢˜æ‰€åœ¨ã€‚æ¥ä¸‹æ¥,è®©æˆ‘å‘æ‚¨å±•ç¤ºå¤„ç†ç¼ºå¤±å€¼çš„ä¸¤ç§ä¸»è¦ç­–ç•¥ã€‚</p>
<h3 id="%E7%AD%96%E7%95%A5%E4%B8%80%E5%88%A0%E9%99%A4%E6%B3%95---%E4%BD%BF%E7%94%A8-dropna"><strong>ç­–ç•¥ä¸€:åˆ é™¤æ³• - ä½¿ç”¨ <code>dropna()</code></strong></h3>
<p>ç¬¬ä¸€ç§æ–¹æ³•ç®€å•ç›´æ¥:ç›´æ¥åˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚æœä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æŸ¥çœ‹åŸå§‹æ•°æ®è¡Œæ•°</span>
print(<span class="hljs-string">f"Original dataset: <span class="hljs-subst">{len(sales_df)}</span> rows"</span>)

<span class="hljs-comment"># åˆ é™¤ä»»ä½•åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ</span>
cleaned_df_dropped = sales_df.dropna()
print(<span class="hljs-string">f"After dropna(): <span class="hljs-subst">{len(cleaned_df_dropped)}</span> rows"</span>)
print(<span class="hljs-string">f"Lost <span class="hljs-subst">{len(sales_df) - len(cleaned_df_dropped)}</span> rows (<span class="hljs-subst">{(len(sales_df) - len(cleaned_df_dropped))/len(sales_df)*<span class="hljs-number">100</span>:<span class="hljs-number">.1</span>f}</span>%)"</span>)

<span class="hljs-comment"># æŸ¥çœ‹åˆ é™¤åçš„æ•°æ®</span>
print(<span class="hljs-string">"\nData after dropping NaN:"</span>)
print(cleaned_df_dropped.info())
</div></code></pre>
<p>æ‚¨çœ‹åˆ°äº†å—?ä½¿ç”¨ <code>dropna()</code> å,æˆ‘ä»¬ä»150è¡Œæ•°æ®å‡å°‘åˆ°äº†å¤§çº¦50è¡Œ,ä¸¢å¤±äº†ä¸‰åˆ†ä¹‹äºŒçš„æ•°æ®!è¿™å°±æ˜¯ <code>dropna()</code> çš„é—®é¢˜æ‰€åœ¨â€”â€”å®ƒæ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚</p>
<p>ä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨ <code>dropna()</code>?</p>
<ul>
<li>å½“ç¼ºå¤±æ•°æ®é‡éå¸¸å°(æ¯”å¦‚å°‘äº5%)æ—¶</li>
<li>å½“æˆ‘ä»¬ç¡®è®¤è¿™äº›è¡Œå¯¹åˆ†æç¡®å®æ— ç”¨æ—¶</li>
<li>å½“ç¼ºå¤±æ•°æ®æ˜¯å®Œå…¨éšæœºåˆ†å¸ƒçš„æ—¶å€™</li>
</ul>
<p>ä½†åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­,ä¸¢å¤±ä¸‰åˆ†ä¹‹äºŒçš„æ•°æ®æ˜¾ç„¶æ˜¯ä¸å¯æ¥å—çš„ã€‚è¿™ä¼šå¯¼è‡´ä¸¥é‡çš„æ•°æ®åè§,å¯èƒ½ä¼šç³»ç»Ÿæ€§åœ°æ’é™¤æŸäº›é‡è¦çš„å®¢æˆ·ç¾¤ä½“æˆ–äº§å“ç±»å‹ã€‚æ‰€ä»¥,æˆ‘ä»¬éœ€è¦æ›´ç²¾ç»†çš„æ–¹æ³•ã€‚</p>
<h3 id="%E7%AD%96%E7%95%A5%E4%BA%8C%E5%A1%AB%E5%85%85%E6%B3%95---%E4%BD%BF%E7%94%A8-fillna"><strong>ç­–ç•¥äºŒ:å¡«å……æ³• - ä½¿ç”¨ <code>fillna()</code></strong></h3>
<p>æ›´ä¸“ä¸šçš„åšæ³•æ˜¯ç”¨åˆç†çš„å€¼æ¥å¡«å……ç¼ºå¤±å€¼ã€‚ä¸åŒçš„åˆ—éœ€è¦ä¸åŒçš„å¡«å……ç­–ç•¥ã€‚è®©æˆ‘é€ä¸€æ¼”ç¤ºã€‚</p>
<p><strong>å¡«å……ç­–ç•¥ 1:ç”¨å›ºå®šå€¼å¡«å……</strong></p>
<p>å¯¹äº <code>discount</code> åˆ—,ç¼ºå¤±å€¼ä»£è¡¨æ²¡æœ‰æŠ˜æ‰£,æ‰€ä»¥ç”¨ 0 å¡«å……æœ€åˆç†ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æ–¹æ³•1:ç”¨0å¡«å……discountåˆ—</span>
<span class="hljs-comment"># åˆ›å»ºå‰¯æœ¬ä»¥ä¿ç•™åŸå§‹æ•°æ®</span>
sales_df_copy = sales_df.copy()

print(<span class="hljs-string">f"Discount missing values before: <span class="hljs-subst">{sales_df_copy[<span class="hljs-string">'discount'</span>].isna().sum()}</span>"</span>)
sales_df_copy[<span class="hljs-string">'discount'</span>].fillna(<span class="hljs-number">0</span>, inplace=<span class="hljs-literal">True</span>)
print(<span class="hljs-string">f"Discount missing values after: <span class="hljs-subst">{sales_df_copy[<span class="hljs-string">'discount'</span>].isna().sum()}</span>"</span>)
</div></code></pre>
<p><strong>å¡«å……ç­–ç•¥ 2:ç”¨å­—ç¬¦ä¸²&quot;Unknown&quot;å¡«å……åˆ†ç±»æ•°æ®</strong></p>
<p>å¯¹äº <code>region</code> åˆ—è¿™æ ·çš„åˆ†ç±»æ•°æ®,ç¼ºå¤±å€¼å¯ä»¥ç”¨ &quot;Unknown&quot; æ ‡è®°ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æ–¹æ³•2:ç”¨"Unknown"å¡«å……regionåˆ—</span>
print(<span class="hljs-string">f"\nRegion missing values before: <span class="hljs-subst">{sales_df_copy[<span class="hljs-string">'region'</span>].isna().sum()}</span>"</span>)
sales_df_copy[<span class="hljs-string">'region'</span>].fillna(<span class="hljs-string">'Unknown'</span>, inplace=<span class="hljs-literal">True</span>)
print(<span class="hljs-string">f"Region missing values after: <span class="hljs-subst">{sales_df_copy[<span class="hljs-string">'region'</span>].isna().sum()}</span>"</span>)

<span class="hljs-comment"># æŸ¥çœ‹regionçš„åˆ†å¸ƒ</span>
print(<span class="hljs-string">"\nRegion distribution after filling:"</span>)
print(sales_df_copy[<span class="hljs-string">'region'</span>].value_counts())
</div></code></pre>
<p><strong>å¡«å……ç­–ç•¥ 3:ç”¨å¹³å‡å€¼(mean)å¡«å……æ•°å€¼æ•°æ®</strong></p>
<p>å¯¹äº <code>list_price</code> è¿™æ ·çš„æ•°å€¼åˆ—,æˆ‘ä»¬å¯ä»¥ç”¨è¯¥åˆ—çš„å¹³å‡å€¼æ¥å¡«å……ã€‚è¿™åœ¨æ•°æ®å‘ˆæ­£æ€åˆ†å¸ƒæ—¶ç‰¹åˆ«æœ‰æ•ˆã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æ–¹æ³•3:ç”¨å¹³å‡å€¼å¡«å……list_priceåˆ—</span>
print(<span class="hljs-string">f"\nList_price missing values before: <span class="hljs-subst">{sales_df_copy[<span class="hljs-string">'list_price'</span>].isna().sum()}</span>"</span>)

<span class="hljs-comment"># è®¡ç®—å¹³å‡å€¼</span>
mean_price = sales_df_copy[<span class="hljs-string">'list_price'</span>].mean()
print(<span class="hljs-string">f"Mean list_price: $<span class="hljs-subst">{mean_price:<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># å¡«å……ç¼ºå¤±å€¼</span>
sales_df_copy[<span class="hljs-string">'list_price'</span>].fillna(mean_price, inplace=<span class="hljs-literal">True</span>)
print(<span class="hljs-string">f"List_price missing values after: <span class="hljs-subst">{sales_df_copy[<span class="hljs-string">'list_price'</span>].isna().sum()}</span>"</span>)
</div></code></pre>
<p><strong>å¡«å……ç­–ç•¥ 4:ç”¨ä¸­ä½æ•°(median)å¡«å……(æ›´ç¨³å¥çš„æ–¹æ³•)</strong></p>
<p>ä½†æ˜¯,å¹³å‡å€¼å®¹æ˜“å—åˆ°æç«¯å€¼çš„å½±å“ã€‚å¦‚æœæ•°æ®ä¸­æœ‰å¼‚å¸¸å€¼,ä¸­ä½æ•°é€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚è®©æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æ–¹æ³•4:å¯¹æ¯”ä½¿ç”¨ä¸­ä½æ•°å¡«å……</span>
<span class="hljs-comment"># åˆ›å»ºå¦ä¸€ä¸ªå‰¯æœ¬</span>
sales_df_median = sales_df.copy()

<span class="hljs-comment"># è®¡ç®—ä¸­ä½æ•°</span>
median_price = sales_df_median[<span class="hljs-string">'list_price'</span>].median()
print(<span class="hljs-string">f"\nMedian list_price: $<span class="hljs-subst">{median_price:<span class="hljs-number">.2</span>f}</span>"</span>)
print(<span class="hljs-string">f"Mean list_price: $<span class="hljs-subst">{mean_price:<span class="hljs-number">.2</span>f}</span>"</span>)
print(<span class="hljs-string">f"Difference: $<span class="hljs-subst">{abs(mean_price - median_price):<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># ç”¨ä¸­ä½æ•°å¡«å……</span>
sales_df_median[<span class="hljs-string">'list_price'</span>].fillna(median_price, inplace=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># å¯¹æ¯”ä¸¤ç§å¡«å……æ–¹æ³•çš„ç»“æœ</span>
print(<span class="hljs-string">"\nComparison of filling methods:"</span>)
print(<span class="hljs-string">f"Mean-filled data average: $<span class="hljs-subst">{sales_df_copy[<span class="hljs-string">'list_price'</span>].mean():<span class="hljs-number">.2</span>f}</span>"</span>)
print(<span class="hljs-string">f"Median-filled data average: $<span class="hljs-subst">{sales_df_median[<span class="hljs-string">'list_price'</span>].mean():<span class="hljs-number">.2</span>f}</span>"</span>)
</div></code></pre>
<p>æ‚¨çœ‹,ä¸­ä½æ•°æ›´åŠ ç¨³å¥,ä¸ä¼šè¢«æç«¯å€¼æ‰€å½±å“ã€‚åœ¨å®é™…å·¥ä½œä¸­,å¦‚æœæ‚¨ä¸ç¡®å®šæ•°æ®åˆ†å¸ƒ,ä¸­ä½æ•°é€šå¸¸æ˜¯æ›´å®‰å…¨çš„é€‰æ‹©ã€‚</p>
<h3 id="%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E4%BD%BF%E7%94%A8%E5%AD%97%E5%85%B8%E4%B8%BA%E4%B8%8D%E5%90%8C%E5%88%97%E6%8C%87%E5%AE%9A%E4%B8%8D%E5%90%8C%E7%9A%84%E5%A1%AB%E5%85%85%E7%AD%96%E7%95%A5"><strong>æœ€ä½³å®è·µ:ä½¿ç”¨å­—å…¸ä¸ºä¸åŒåˆ—æŒ‡å®šä¸åŒçš„å¡«å……ç­–ç•¥</strong></h3>
<p>æœ€ä¸“ä¸šçš„åšæ³•æ˜¯ç”¨ä¸€ä¸ªå­—å…¸,ä¸€æ¬¡æ€§ä¸ºå¤šä¸ªåˆ—æŒ‡å®šå„è‡ªæœ€åˆé€‚çš„å¡«å……å€¼ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æœ€ä½³å®è·µ:ä½¿ç”¨å­—å…¸ç»Ÿä¸€å¤„ç†æ‰€æœ‰ç¼ºå¤±å€¼</span>
sales_df = sales_df.copy()

<span class="hljs-comment"># åˆ›å»ºå¡«å……å€¼å­—å…¸</span>
fill_values = {
    <span class="hljs-string">'discount'</span>: <span class="hljs-number">0</span>,                                  <span class="hljs-comment"># æ— æŠ˜æ‰£ç”¨0</span>
    <span class="hljs-string">'region'</span>: <span class="hljs-string">'Unknown'</span>,                            <span class="hljs-comment"># æœªçŸ¥åœ°åŒºç”¨Unknown</span>
    <span class="hljs-string">'list_price'</span>: sales_df[<span class="hljs-string">'list_price'</span>].median()  <span class="hljs-comment"># ä»·æ ¼ç”¨ä¸­ä½æ•°</span>
}

<span class="hljs-comment"># ä¸€æ¬¡æ€§å¡«å……æ‰€æœ‰åˆ—</span>
sales_df.fillna(value=fill_values, inplace=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># éªŒè¯ç»“æœ</span>
print(<span class="hljs-string">"\nFinal missing value check:"</span>)
print(sales_df.isna().sum())
print(<span class="hljs-string">"\næ•°æ®å·²æ¸…æ´—å®Œæˆ!"</span>)
</div></code></pre>
<p>å®Œç¾!ç°åœ¨æˆ‘ä»¬çš„æ•°æ®å·²ç»æ²¡æœ‰ç¼ºå¤±å€¼äº†,è€Œä¸”æˆ‘ä»¬ä¿ç•™äº†æ‰€æœ‰150è¡Œæ•°æ®,æ²¡æœ‰ä¸¢å¤±ä»»ä½•ä¿¡æ¯ã€‚è¿™å°±æ˜¯ä¸“ä¸šçš„æ•°æ®æ¸…æ´—æ–¹æ³•ã€‚</p>
<p>æ¥ä¸‹æ¥,æˆ‘ä»¬è¦å¤„ç†æ ¼å¼ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p>
<p><strong>æ ‡å‡†åŒ– region åˆ—</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># æŸ¥çœ‹regionåˆ—çš„å”¯ä¸€å€¼</span>
print(<span class="hljs-string">"Unique regions before cleaning:"</span>)
print(sales_df[<span class="hljs-string">'region'</span>].unique())

<span class="hljs-comment"># æ ‡å‡†åŒ–regionåˆ—:ç»Ÿä¸€è½¬ä¸ºå°å†™,å¹¶å°†'eu'æ›¿æ¢ä¸º'europe'</span>
sales_df[<span class="hljs-string">'region'</span>] = sales_df[<span class="hljs-string">'region'</span>].str.lower().str.strip()
sales_df[<span class="hljs-string">'region'</span>] = sales_df[<span class="hljs-string">'region'</span>].replace(<span class="hljs-string">'eu'</span>, <span class="hljs-string">'europe'</span>)

print(<span class="hljs-string">"\nUnique regions after cleaning:"</span>)
print(sales_df[<span class="hljs-string">'region'</span>].unique())
</div></code></pre>
<p><strong>æ ‡å‡†åŒ– status åˆ—</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># æŸ¥çœ‹statusåˆ—çš„å”¯ä¸€å€¼</span>
print(<span class="hljs-string">"\nUnique statuses before cleaning:"</span>)
print(sales_df[<span class="hljs-string">'status'</span>].unique())

<span class="hljs-comment"># æ ‡å‡†åŒ–statusåˆ—</span>
sales_df[<span class="hljs-string">'status'</span>] = sales_df[<span class="hljs-string">'status'</span>].str.lower().str.strip()

<span class="hljs-comment"># åˆ›å»ºæ ‡å‡†åŒ–æ˜ å°„å­—å…¸</span>
status_mapping = {
    <span class="hljs-string">'shipped'</span>: <span class="hljs-string">'Shipped'</span>,
    <span class="hljs-string">'s'</span>: <span class="hljs-string">'Shipped'</span>,
    <span class="hljs-string">'returned'</span>: <span class="hljs-string">'Returned'</span>,
    <span class="hljs-string">'r'</span>: <span class="hljs-string">'Returned'</span>,
    <span class="hljs-string">'pending'</span>: <span class="hljs-string">'Pending'</span>,
    <span class="hljs-string">'p'</span>: <span class="hljs-string">'Pending'</span>,
    <span class="hljs-string">'cancelled'</span>: <span class="hljs-string">'Cancelled'</span>,
    <span class="hljs-string">'c'</span>: <span class="hljs-string">'Cancelled'</span>
}

sales_df[<span class="hljs-string">'status'</span>] = sales_df[<span class="hljs-string">'status'</span>].map(status_mapping)

print(<span class="hljs-string">"\nUnique statuses after cleaning:"</span>)
print(sales_df[<span class="hljs-string">'status'</span>].unique())
</div></code></pre>
<p><strong>æ ‡å‡†åŒ– product_id åˆ—å¹¶æ£€æŸ¥é‡å¤</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># å°†product_idç»Ÿä¸€è½¬ä¸ºå°å†™</span>
sales_df[<span class="hljs-string">'product_id'</span>] = sales_df[<span class="hljs-string">'product_id'</span>].str.lower()
product_df[<span class="hljs-string">'product_id'</span>] = product_df[<span class="hljs-string">'product_id'</span>].str.lower()

<span class="hljs-comment"># æ£€æŸ¥é‡å¤è¡Œ</span>
duplicates = sales_df.duplicated().sum()
print(<span class="hljs-string">f"\nNumber of duplicate rows: <span class="hljs-subst">{duplicates}</span>"</span>)

<span class="hljs-comment"># å¦‚æœå­˜åœ¨é‡å¤,åˆ é™¤å®ƒä»¬</span>
<span class="hljs-keyword">if</span> duplicates &gt; <span class="hljs-number">0</span>:
    print(<span class="hljs-string">"Duplicate rows found:"</span>)
    print(sales_df[sales_df.duplicated(keep=<span class="hljs-literal">False</span>)].sort_values(<span class="hljs-string">'transaction_id'</span>))
    sales_df.drop_duplicates(inplace=<span class="hljs-literal">True</span>)
    print(<span class="hljs-string">f"Removed <span class="hljs-subst">{duplicates}</span> duplicate rows"</span>)
    print(<span class="hljs-string">f"Final dataset: <span class="hljs-subst">{len(sales_df)}</span> rows"</span>)
</div></code></pre>
<hr>
<h2 id="%E7%AC%AC%E5%9B%9B%E8%8A%82%E6%A8%A1%E5%9D%97%E4%B8%89---%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B"><strong>ç¬¬å››èŠ‚:æ¨¡å—ä¸‰ - ç‰¹å¾å·¥ç¨‹</strong></h2>
<p><strong>(20:00 - 24:00)</strong></p>
<p>ç°åœ¨æ¥åˆ°äº†ä¸€ä¸ªéå¸¸å…³é”®çš„æ­¥éª¤â€”â€”ç‰¹å¾å·¥ç¨‹ã€‚æ‚¨å¯èƒ½æ³¨æ„åˆ°äº†,æˆ‘ä»¬çš„æ•°æ®é›†é‡Œæ²¡æœ‰ <code>sales</code>(é”€å”®é¢)è¿™ä¸€åˆ—ã€‚è¿™å…¶å®å¾ˆç¬¦åˆçœŸå®åœºæ™¯:é”€å”®é¢é€šå¸¸æ˜¯åˆ†æå¸ˆæ ¹æ®åŸå§‹æ•°æ®è®¡ç®—å‡ºæ¥çš„æ´¾ç”Ÿå­—æ®µã€‚</p>
<p>åœ¨çœŸå®çš„ç”µå•†ç¯å¢ƒä¸­,æœ€ç»ˆé”€å”®é¢çš„è®¡ç®—å…¬å¼æ˜¯:
<strong>final_sales = quantity Ã— list_price Ã— (1 - discount)</strong></p>
<p>è¿™ä¸ªå…¬å¼è€ƒè™‘äº†è´­ä¹°æ•°é‡ã€æ ‡ä»·,ä»¥åŠä»»ä½•å¯èƒ½çš„æŠ˜æ‰£ã€‚è®©æˆ‘ä»¬æ¥åˆ›å»ºè¿™ä¸ªæ–°åˆ—ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># åˆ›å»ºfinal_salesåˆ—</span>
sales_df[<span class="hljs-string">'final_sales'</span>] = sales_df[<span class="hljs-string">'quantity'</span>] * sales_df[<span class="hljs-string">'list_price'</span>] * (<span class="hljs-number">1</span> - sales_df[<span class="hljs-string">'discount'</span>])

<span class="hljs-comment"># æŸ¥çœ‹ç»“æœ</span>
print(<span class="hljs-string">"Data with calculated sales:"</span>)
print(sales_df[[<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'quantity'</span>, <span class="hljs-string">'list_price'</span>, <span class="hljs-string">'discount'</span>, <span class="hljs-string">'final_sales'</span>]].head(<span class="hljs-number">10</span>))

<span class="hljs-comment"># æŸ¥çœ‹é”€å”®é¢çš„ç»Ÿè®¡ä¿¡æ¯</span>
print(<span class="hljs-string">"\nSales statistics:"</span>)
print(sales_df[<span class="hljs-string">'final_sales'</span>].describe())
</div></code></pre>
<p>è¿™å°±æ˜¯ç‰¹å¾å·¥ç¨‹çš„å¨åŠ›!æˆ‘ä»¬ä»ç°æœ‰çš„åˆ—åˆ›é€ å‡ºäº†ä¸€ä¸ªæ–°çš„ã€æ›´æœ‰æ„ä¹‰çš„æŒ‡æ ‡ã€‚è¿™ä¸ª <code>final_sales</code> åˆ—å°†æ˜¯æˆ‘ä»¬åç»­åˆ†æçš„æ ¸å¿ƒã€‚</p>
<hr>
<h2 id="%E7%AC%AC%E4%BA%94%E8%8A%82%E6%A8%A1%E5%9D%97%E5%9B%9B---%E7%AD%9B%E9%80%89%E4%B8%8E%E9%80%89%E6%8B%A9%E6%95%B0%E6%8D%AE"><strong>ç¬¬äº”èŠ‚:æ¨¡å—å›› - ç­›é€‰ä¸é€‰æ‹©æ•°æ®</strong></h2>
<p><strong>(24:00 - 29:00)</strong></p>
<p>æ•°æ®å·²ç»å¹²å‡€å¹¶ä¸”å‡†å¤‡å¥½äº†,ä½†å®ƒåŒ…å«äº†å…¨çƒæ‰€æœ‰åœ°åŒºçš„ä¿¡æ¯,ä»¥åŠæ‰€æœ‰çŠ¶æ€çš„è®¢å•ã€‚è€æ¿çš„é—®é¢˜å¾ˆæ˜ç¡®:åªå…³æ³¨æ¬§æ´²å¸‚åœºçš„æœ‰æ•ˆè®¢å•ã€‚æˆ‘ä»¬éœ€è¦è¿›è¡Œç²¾ç¡®çš„æ•°æ®ç­›é€‰ã€‚</p>
<p>åœ¨Pandasä¸­,æœ€å¸¸ç”¨çš„ç­›é€‰æ–¹å¼å«åš&quot;å¸ƒå°”ç´¢å¼•&quot;ã€‚æˆ‘ä»¬å¯ä»¥ç»„åˆå¤šä¸ªæ¡ä»¶æ¥ç²¾ç¡®ç­›é€‰æ•°æ®ã€‚é¦–å…ˆ,æˆ‘ä»¬åªè¦æ¬§æ´²åœ°åŒºçš„æ•°æ®ã€‚å…¶æ¬¡,æˆ‘ä»¬è¦æ’é™¤å·²é€€è´§(Returned)å’Œå·²å–æ¶ˆ(Cancelled)çš„è®¢å•,å› ä¸ºè¿™äº›ä¸ä»£è¡¨çœŸå®çš„é”€å”®ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æ–¹æ³•1:ä½¿ç”¨å¸ƒå°”ç´¢å¼•è¿›è¡Œå¤šæ¡ä»¶ç­›é€‰</span>
valid_europe_sales = sales_df[
    (sales_df[<span class="hljs-string">'region'</span>] == <span class="hljs-string">'europe'</span>) &amp; 
    (sales_df[<span class="hljs-string">'status'</span>].isin([<span class="hljs-string">'Shipped'</span>, <span class="hljs-string">'Pending'</span>]))
]

print(<span class="hljs-string">f"Total transactions: <span class="hljs-subst">{len(sales_df)}</span>"</span>)
print(<span class="hljs-string">f"Valid Europe transactions: <span class="hljs-subst">{len(valid_europe_sales)}</span>"</span>)
print(<span class="hljs-string">f"Percentage: <span class="hljs-subst">{len(valid_europe_sales)/len(sales_df)*<span class="hljs-number">100</span>:<span class="hljs-number">.1</span>f}</span>%"</span>)
print(<span class="hljs-string">f"\nSample of filtered data:"</span>)
print(valid_europe_sales.head())
</div></code></pre>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº† <code>&amp;</code> è¿ç®—ç¬¦æ¥ç»„åˆæ¡ä»¶,è¿˜ä½¿ç”¨äº† <code>.isin()</code> æ–¹æ³•æ¥æ£€æŸ¥çŠ¶æ€æ˜¯å¦åœ¨æˆ‘ä»¬æŒ‡å®šçš„æœ‰æ•ˆåˆ—è¡¨ä¸­ã€‚æ³¨æ„æ¯ä¸ªæ¡ä»¶éƒ½ç”¨æ‹¬å·æ‹¬èµ·æ¥,è¿™å¾ˆé‡è¦ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬è¿˜æƒ³é€‰æ‹©ç‰¹å®šçš„åˆ—,æœ€ä¸“ä¸šçš„åšæ³•æ˜¯ä½¿ç”¨ <code>.loc</code> è®¿é—®å™¨ã€‚å®ƒçš„è¯­æ³•æ˜¯ <code>df.loc[è¡Œæ¡ä»¶, åˆ—ååˆ—è¡¨]</code>ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æ–¹æ³•2:ä½¿ç”¨.locåŒæ—¶ç­›é€‰è¡Œå’Œé€‰æ‹©åˆ—</span>
europe_key_data = sales_df.loc[
    (sales_df[<span class="hljs-string">'region'</span>] == <span class="hljs-string">'europe'</span>) &amp; 
    (sales_df[<span class="hljs-string">'status'</span>].isin([<span class="hljs-string">'Shipped'</span>, <span class="hljs-string">'Pending'</span>])),
    [<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'customer_id'</span>, <span class="hljs-string">'product_id'</span>, <span class="hljs-string">'final_sales'</span>, <span class="hljs-string">'sale_date'</span>]
]

print(europe_key_data.head())
</div></code></pre>
<p>ä½¿ç”¨ <code>.loc</code> çš„ä¸€ä¸ªé‡è¦åŸå› æ˜¯å®ƒå¯ä»¥é¿å… <code>SettingWithCopyWarning</code> è­¦å‘Šã€‚è¿™ç§æ–¹å¼æ„å›¾æ˜ç¡®,æ˜¯å®˜æ–¹æ¨èçš„æœ€ä½³å®è·µã€‚</p>
<p>è®©æˆ‘ä»¬ä¹Ÿçœ‹çœ‹é‚£äº›è¢«æˆ‘ä»¬è¿‡æ»¤æ‰çš„è®¢å•,äº†è§£ä¸€ä¸‹æ•°æ®çš„å…¨è²Œã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æŸ¥çœ‹è¢«æ’é™¤çš„è®¢å•çŠ¶æ€åˆ†å¸ƒ</span>
excluded_orders = sales_df[~sales_df[<span class="hljs-string">'status'</span>].isin([<span class="hljs-string">'Shipped'</span>, <span class="hljs-string">'Pending'</span>])]
print(<span class="hljs-string">"\nExcluded order status distribution:"</span>)
print(excluded_orders[<span class="hljs-string">'status'</span>].value_counts())
print(<span class="hljs-string">f"\nTotal excluded: <span class="hljs-subst">{len(excluded_orders)}</span> orders"</span>)
print(<span class="hljs-string">f"Excluded revenue: $<span class="hljs-subst">{excluded_orders[<span class="hljs-string">'final_sales'</span>].sum():,<span class="hljs-number">.2</span>f}</span>"</span>)
</div></code></pre>
<hr>
<h2 id="%E7%AC%AC%E5%85%AD%E8%8A%82%E6%A8%A1%E5%9D%97%E4%BA%94---%E6%95%B0%E6%8D%AE%E6%8E%92%E5%BA%8F"><strong>ç¬¬å…­èŠ‚:æ¨¡å—äº” - æ•°æ®æ’åº</strong></h2>
<p><strong>(29:00 - 34:00)</strong></p>
<p>ç­›é€‰å¸®æˆ‘ä»¬å¾—åˆ°äº†æ­£ç¡®çš„æ•°æ®å­é›†,ä½†å®ƒä»¬å¾€å¾€æ˜¯æ— åºçš„ã€‚æ’åºèƒ½è®©æˆ‘ä»¬å‘ç°æ•°æ®ä¸­çš„æ¨¡å¼å’Œè¶‹åŠ¿ã€‚Pandasæä¾›äº†ä¸¤ä¸ªä¸»è¦çš„æ’åºå‡½æ•°,è®©æˆ‘è¯¦ç»†æ¼”ç¤ºå®ƒä»¬çš„åŒºåˆ«å’Œç”¨æ³•ã€‚</p>
<h3 id="%E6%8C%89%E5%80%BC%E6%8E%92%E5%BA%8F---sortvalues"><strong>æŒ‰å€¼æ’åº - <code>sort_values()</code></strong></h3>
<p>ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„å‡½æ•°æ˜¯ <code>sort_values()</code>,å®ƒæ ¹æ®ä¸€åˆ—æˆ–å¤šåˆ—çš„å®é™…æ•°å€¼è¿›è¡Œæ’åºã€‚</p>
<p><strong>å•åˆ—æ’åº:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># æŒ‰é”€å”®é¢é™åºæ’åˆ—,æ‰¾å‡ºæœ€é«˜çš„äº¤æ˜“</span>
top_sales = valid_europe_sales.sort_values(by=<span class="hljs-string">'final_sales'</span>, ascending=<span class="hljs-literal">False</span>)

print(<span class="hljs-string">"Top 10 transactions by sales value:"</span>)
print(top_sales[[<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'product_id'</span>, <span class="hljs-string">'quantity'</span>, <span class="hljs-string">'final_sales'</span>]].head(<span class="hljs-number">10</span>))

<span class="hljs-comment"># ä¹Ÿå¯ä»¥çœ‹æœ€ä½çš„</span>
print(<span class="hljs-string">"\nBottom 5 transactions by sales value:"</span>)
print(top_sales[[<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'product_id'</span>, <span class="hljs-string">'quantity'</span>, <span class="hljs-string">'final_sales'</span>]].tail(<span class="hljs-number">5</span>))
</div></code></pre>
<p><strong>å¤šåˆ—æ’åº:</strong></p>
<p><code>sort_values()</code> çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå¯ä»¥åŒæ—¶æŒ‰å¤šä¸ªåˆ—æ’åºã€‚è¿™åœ¨éœ€è¦å¤šçº§æ’åºæ—¶éå¸¸æœ‰ç”¨ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># å¤šçº§æ’åº:å…ˆæŒ‰äº§å“ID,å†æŒ‰é”€å”®é¢</span>
multi_sorted = valid_europe_sales.sort_values(
    by=[<span class="hljs-string">'product_id'</span>, <span class="hljs-string">'final_sales'</span>],
    ascending=[<span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>]  <span class="hljs-comment"># äº§å“IDå‡åº,é”€å”®é¢é™åº</span>
)

print(<span class="hljs-string">"\nMulti-level sort (by product_id, then by final_sales):"</span>)
print(multi_sorted[[<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'product_id'</span>, <span class="hljs-string">'final_sales'</span>, <span class="hljs-string">'sale_date'</span>]].head(<span class="hljs-number">15</span>))

<span class="hljs-comment"># è¿™æ ·æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ªäº§å“ä¸­é”€å”®é¢æœ€é«˜çš„äº¤æ˜“</span>
</div></code></pre>
<p>æ³¨æ„,<code>ascending</code> å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨,ä¸ºæ¯ä¸€åˆ—åˆ†åˆ«æŒ‡å®šå‡åºè¿˜æ˜¯é™åºã€‚è¿™ç»™äº†æˆ‘ä»¬æå¤§çš„çµæ´»æ€§ã€‚</p>
<h3 id="%E6%8C%89%E7%B4%A2%E5%BC%95%E6%8E%92%E5%BA%8F---sortindex"><strong>æŒ‰ç´¢å¼•æ’åº - <code>sort_index()</code></strong></h3>
<p>ç¬¬äºŒä¸ªå‡½æ•°æ˜¯ <code>sort_index()</code>,å®ƒä¸çœ‹æ•°æ®çš„å€¼,è€Œæ˜¯æ ¹æ®è¡Œçš„ç´¢å¼•æ ‡ç­¾æ¥æ’åºã€‚è¿™åœ¨ä»€ä¹ˆæ—¶å€™æœ‰ç”¨å‘¢?è®©æˆ‘æ¼”ç¤ºå‡ ä¸ªåœºæ™¯ã€‚</p>
<p><strong>åœºæ™¯1:æ¢å¤åŸå§‹é¡ºåº</strong></p>
<p>å½“æ•°æ®ç»è¿‡å¤šæ¬¡ç­›é€‰å’Œæ’åºå,ç´¢å¼•å¯èƒ½å˜å¾—æ··ä¹±ã€‚ä½¿ç”¨ <code>sort_index()</code> å¯ä»¥æ¢å¤åŸå§‹çš„è¡Œé¡ºåºã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æŸ¥çœ‹å½“å‰ç´¢å¼•é¡ºåº(ç»è¿‡æ’åºåå·²ç»ä¹±äº†)</span>
print(<span class="hljs-string">"Current index after sorting:"</span>)
print(top_sales.index[:<span class="hljs-number">20</span>].tolist())

<span class="hljs-comment"># ä½¿ç”¨sort_indexæ¢å¤åŸå§‹é¡ºåº</span>
restored_order = top_sales.sort_index()
print(<span class="hljs-string">"\nIndex after sort_index():"</span>)
print(restored_order.index[:<span class="hljs-number">20</span>].tolist())

<span class="hljs-comment"># ç°åœ¨æ•°æ®æŒ‰ç…§åŸå§‹CSVæ–‡ä»¶çš„é¡ºåºæ’åˆ—äº†</span>
print(<span class="hljs-string">"\nData in original order:"</span>)
print(restored_order[[<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'final_sales'</span>]].head())
</div></code></pre>
<p><strong>åœºæ™¯2:å½“ç´¢å¼•æœ¬èº«æœ‰æ„ä¹‰æ—¶</strong></p>
<p>æœ‰æ—¶å€™,æˆ‘ä»¬ä¼šå°†æŸä¸ªæœ‰æ„ä¹‰çš„åˆ—è®¾ç½®ä¸ºç´¢å¼•,æ¯”å¦‚æ—¥æœŸæˆ–è€…äº§å“IDã€‚è¿™æ—¶ <code>sort_index()</code> å°±ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># å°†sale_dateè®¾ç½®ä¸ºç´¢å¼•</span>
date_indexed = valid_europe_sales.copy()
date_indexed[<span class="hljs-string">'sale_date'</span>] = pd.to_datetime(date_indexed[<span class="hljs-string">'sale_date'</span>])
date_indexed = date_indexed.set_index(<span class="hljs-string">'sale_date'</span>)

print(<span class="hljs-string">"\nBefore sorting by date index:"</span>)
print(date_indexed[[<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'final_sales'</span>]].head())

<span class="hljs-comment"># æŒ‰æ—¥æœŸç´¢å¼•æ’åº</span>
date_sorted = date_indexed.sort_index()
print(<span class="hljs-string">"\nAfter sorting by date index:"</span>)
print(date_sorted[[<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'final_sales'</span>]].head())

<span class="hljs-comment"># ä¹Ÿå¯ä»¥é™åºæ’åˆ—(æœ€æ–°çš„æ—¥æœŸåœ¨å‰)</span>
date_sorted_desc = date_indexed.sort_index(ascending=<span class="hljs-literal">False</span>)
print(<span class="hljs-string">"\nDate sorted descending (newest first):"</span>)
print(date_sorted_desc[[<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'final_sales'</span>]].head())
</div></code></pre>
<h3 id="%E6%80%BB%E7%BB%93sortvalues-vs-sortindex"><strong>æ€»ç»“:<code>sort_values()</code> vs <code>sort_index()</code></strong></h3>
<p>ç®€å•æ¥è¯´:</p>
<ul>
<li><strong><code>sort_values()</code></strong>:æŒ‰åˆ—çš„æ•°æ®å€¼æ’åº â†’ ç”¨äºå‘ç°æœ€å¤§å€¼ã€æœ€å°å€¼ã€æ’å</li>
<li><strong><code>sort_index()</code></strong>:æŒ‰è¡Œçš„ç´¢å¼•æ ‡ç­¾æ’åº â†’ ç”¨äºæ¢å¤é¡ºåºã€æŒ‰æ—¶é—´åºåˆ—æ’åˆ—</li>
</ul>
<p>ä¸¤ä¸ªå‡½æ•°éƒ½æ”¯æŒ <code>ascending</code> å‚æ•°æ¥æ§åˆ¶å‡åºæˆ–é™åº,ä¹Ÿéƒ½æ”¯æŒ <code>inplace=True</code> æ¥ç›´æ¥ä¿®æ”¹åŸå§‹DataFrameã€‚</p>
<hr>
<h2 id="%E7%AC%AC%E4%B8%83%E8%8A%82%E6%A8%A1%E5%9D%97%E5%85%AD---%E5%90%88%E5%B9%B6%E4%B8%8E%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE"><strong>ç¬¬ä¸ƒèŠ‚:æ¨¡å—å…­ - åˆå¹¶ä¸è¿æ¥æ•°æ®</strong></h2>
<p><strong>(34:00 - 39:00)</strong></p>
<p>ç°åœ¨æ¥åˆ°å…³é”®çš„ä¸€æ­¥ã€‚æˆ‘ä»¬æœ‰ä¸‰ä¸ªç‹¬ç«‹çš„æ•°æ®è¡¨:é”€å”®è®°å½•ã€äº§å“ä¿¡æ¯å’Œå®¢æˆ·ä¿¡æ¯ã€‚è¦å›ç­”&quot;å“ªä¸ªäº§å“ç±»åˆ«é”€å”®é¢æœ€é«˜&quot;è¿™ä¸ªé—®é¢˜,æˆ‘ä»¬å¿…é¡»æŠŠäº§å“çš„ç±»åˆ«ä¿¡æ¯å’Œé”€å”®æ•°æ®è¿æ¥èµ·æ¥ã€‚è¿™å°±æ˜¯æ•°æ®åˆå¹¶çš„ä½œç”¨ã€‚</p>
<p>Pandasä¸­ç”¨äºæ­¤ä»»åŠ¡çš„æ ¸å¿ƒå‡½æ•°æ˜¯ <code>pd.merge()</code>ã€‚æˆ‘ä»¬å°†åˆ†æ­¥è¿›è¡Œåˆå¹¶ã€‚é¦–å…ˆ,åˆå¹¶é”€å”®æ•°æ®å’Œäº§å“æ•°æ®ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># ç¬¬ä¸€æ­¥:åˆå¹¶æœ‰æ•ˆçš„æ¬§æ´²é”€å”®æ•°æ®å’Œäº§å“æ•°æ®</span>
merged_df = pd.merge(
    valid_europe_sales,
    product_df,
    on=<span class="hljs-string">'product_id'</span>,
    how=<span class="hljs-string">'left'</span>
)

print(<span class="hljs-string">"After merging with product data:"</span>)
print(merged_df.head())
print(<span class="hljs-string">f"\nShape: <span class="hljs-subst">{merged_df.shape}</span>"</span>)

<span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æœ‰äº§å“ä¿¡æ¯ç¼ºå¤±çš„æƒ…å†µ</span>
missing_products = merged_df[<span class="hljs-string">'category'</span>].isna().sum()
print(<span class="hljs-string">f"Transactions with missing product info: <span class="hljs-subst">{missing_products}</span>"</span>)
</div></code></pre>
<p>è¿™é‡Œçš„ <code>on='product_id'</code> æŒ‡å®šäº†ç”¨äºè¿æ¥çš„å…±åŒåˆ—ã€‚<code>how='left'</code> è¡¨ç¤ºæˆ‘ä»¬ä½¿ç”¨å·¦è¿æ¥,ä¿ç•™å·¦è¾¹è¡¨(é”€å”®è®°å½•)çš„æ‰€æœ‰è¡Œã€‚å¦‚æœæŸä¸ªäº§å“åœ¨äº§å“è¡¨ä¸­æ‰¾ä¸åˆ°,ç›¸å…³çš„äº§å“ä¿¡æ¯åˆ—ä¼šæ˜¾ç¤ºä¸º NaNã€‚</p>
<p>æ¥ä¸‹æ¥,æˆ‘ä»¬å°†ç»“æœä¸å®¢æˆ·æ•°æ®åˆå¹¶,ä»¥è·å¾—å®Œæ•´çš„åˆ†ææ•°æ®é›†ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># ç¬¬äºŒæ­¥:åˆå¹¶ä¸Šä¸€æ­¥ç»“æœå’Œå®¢æˆ·æ•°æ®</span>
full_df = pd.merge(
    merged_df,
    customer_df,
    on=<span class="hljs-string">'customer_id'</span>,
    how=<span class="hljs-string">'left'</span>
)

print(<span class="hljs-string">"\nFinal merged dataset:"</span>)
print(full_df.head())
print(<span class="hljs-string">f"\nFinal shape: <span class="hljs-subst">{full_df.shape}</span>"</span>)
print(<span class="hljs-string">f"Columns: <span class="hljs-subst">{list(full_df.columns)}</span>"</span>)
</div></code></pre>
<p>è®©æˆ‘å¿«é€Ÿè§£é‡Šä¸€ä¸‹ä¸åŒçš„åˆå¹¶ç±»å‹ã€‚ç†è§£è¿™äº›å¯¹äºæ­£ç¡®å¤„ç†æ•°æ®è‡³å…³é‡è¦ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">è¿æ¥ç±»å‹ (<code>how</code>)</th>
<th style="text-align:left">ç±»æ¯”</th>
<th style="text-align:left">ä¿ç•™çš„æ•°æ®</th>
<th style="text-align:left">ä½¿ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>inner</code> (å†…è¿æ¥)</td>
<td style="text-align:left">ä¸¤ä¸ªåœ†çš„äº¤é›†</td>
<td style="text-align:left">ä»…ä¿ç•™åœ¨<strong>ä¸¤ä¸ª</strong>è¡¨ä¸­é”®éƒ½åŒ¹é…çš„è¡Œ</td>
<td style="text-align:left">åªå…³å¿ƒå®Œæ•´åŒ¹é…çš„æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left"><code>left</code> (å·¦è¿æ¥)</td>
<td style="text-align:left">ä¿ç•™å·¦è¾¹åœ†çš„å…¨éƒ¨</td>
<td style="text-align:left">ä¿ç•™<strong>å·¦</strong>è¡¨çš„æ‰€æœ‰è¡Œ,ä»¥åŠå³è¡¨ä¸­åŒ¹é…çš„è¡Œ</td>
<td style="text-align:left">ä¿ç•™ä¸»è¡¨çš„å®Œæ•´æ€§(å¦‚æ‰€æœ‰é”€å”®è®°å½•)</td>
</tr>
<tr>
<td style="text-align:left"><code>right</code> (å³è¿æ¥)</td>
<td style="text-align:left">ä¿ç•™å³è¾¹åœ†çš„å…¨éƒ¨</td>
<td style="text-align:left">ä¿ç•™<strong>å³</strong>è¡¨çš„æ‰€æœ‰è¡Œ,ä»¥åŠå·¦è¡¨ä¸­åŒ¹é…çš„è¡Œ</td>
<td style="text-align:left">ç±»ä¼¼left,ä½†ä¸»è¡¨åœ¨å³è¾¹</td>
</tr>
<tr>
<td style="text-align:left"><code>outer</code> (å¤–è¿æ¥)</td>
<td style="text-align:left">ä¸¤ä¸ªåœ†çš„å¹¶é›†</td>
<td style="text-align:left">ä¿ç•™<strong>ä¸¤ä¸ª</strong>è¡¨çš„æ‰€æœ‰è¡Œ,ä¸åŒ¹é…å¤„ç”¨NaNå¡«å……</td>
<td style="text-align:left">éœ€è¦çœ‹åˆ°æ‰€æœ‰æ•°æ®,åŒ…æ‹¬ä¸åŒ¹é…çš„</td>
</tr>
</tbody>
</table>
<p>åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­,ä½¿ç”¨ <code>left</code> è¿æ¥ç¡®ä¿äº†ä¸ä¼šä¸¢å¤±ä»»ä½•é”€å”®è®°å½•,å³ä½¿æŸäº›äº§å“æˆ–å®¢æˆ·ä¿¡æ¯å¯èƒ½ç¼ºå¤±ã€‚</p>
<hr>
<h2 id="%E7%AC%AC%E5%85%AB%E8%8A%82%E6%A8%A1%E5%9D%97%E4%B8%83---%E5%88%86%E7%BB%84%E4%B8%8E%E8%81%9A%E5%90%88"><strong>ç¬¬å…«èŠ‚:æ¨¡å—ä¸ƒ - åˆ†ç»„ä¸èšåˆ</strong></h2>
<p><strong>(39:00 - 45:30)</strong></p>
<p>å¤ªæ£’äº†!æˆ‘ä»¬ç°åœ¨ç»ˆäºæ‹¥æœ‰äº†ä¸€ä¸ªå¹²å‡€ã€ç»Ÿä¸€ã€å®Œæ•´çš„æ•°æ®é›†ã€‚ç°åœ¨,æˆ‘ä»¬å¯ä»¥å›ç­”è€æ¿æœ€åˆçš„é—®é¢˜äº†:æ¬§æ´²å¸‚åœºå“ªä¸ªäº§å“ç±»åˆ«çš„é”€å”®é¢æœ€é«˜?æˆ‘ä»¬å°†ä½¿ç”¨æ•°æ®åˆ†æä¸­æœ€å¼ºå¤§çš„æ€æƒ³ä¹‹ä¸€:&quot;æ‹†åˆ†-åº”ç”¨-åˆå¹¶&quot;(Split-Apply-Combine)ç­–ç•¥ã€‚</p>
<p>è¿™ä¸ªç­–ç•¥å¾ˆç®€å•:æˆ‘ä»¬å…ˆæŠŠæ•°æ®æŒ‰æŸä¸ªæ ‡å‡†(æ¯”å¦‚äº§å“ç±»åˆ«)<strong>æ‹†åˆ†</strong>æˆä¸åŒçš„å°ç»„,ç„¶åå¯¹æ¯ä¸ªå°ç»„<strong>åº”ç”¨</strong>ä¸€ä¸ªè®¡ç®—(æ¯”å¦‚æ±‚å’Œ),æœ€åæŠŠæ‰€æœ‰ç»“æœ<strong>åˆå¹¶</strong>æˆä¸€ä¸ªæ–°çš„æ±‡æ€»è¡¨ã€‚</p>
<p>åœ¨Pandasä¸­,è¿™é€šè¿‡ <code>groupby()</code> å‡½æ•°å®ç°ã€‚è®©æˆ‘ä»¬æ¥æ‰¾å‡ºæ¬§æ´²å¸‚åœºæ¯ä¸ªäº§å“ç±»åˆ«çš„æ€»é”€å”®é¢ã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># æŒ‰äº§å“ç±»åˆ«åˆ†ç»„,å¹¶è®¡ç®—æ¯ä¸ªç±»åˆ«çš„é”€å”®æ€»é¢</span>
category_sales = full_df.groupby(<span class="hljs-string">'category'</span>)[<span class="hljs-string">'final_sales'</span>].sum()

<span class="hljs-comment"># æ’åºä»¥æ‰¾å‡ºæœ€ç•…é”€çš„ç±»åˆ«</span>
top_categories = category_sales.sort_values(ascending=<span class="hljs-literal">False</span>)

print(<span class="hljs-string">"Sales by Category (Europe, Valid Orders):"</span>)
print(top_categories)
print(<span class="hljs-string">f"\næœ€ç•…é”€ç±»åˆ«: <span class="hljs-subst">{top_categories.index[<span class="hljs-number">0</span>]}</span>"</span>)
print(<span class="hljs-string">f"é”€å”®é¢: $<span class="hljs-subst">{top_categories.iloc[<span class="hljs-number">0</span>]:,<span class="hljs-number">.2</span>f}</span>"</span>)
</div></code></pre>
<p>æˆ‘ä»¬æ¥æ‹†è§£è¿™è¡Œæ ¸å¿ƒä»£ç :<code>full_df.groupby('category')</code> å®Œæˆäº†&quot;æ‹†åˆ†&quot;,æŒ‰ç±»åˆ«å°†æ•°æ®åˆ†ç»„;<code>['final_sales']</code> é€‰æ‹©äº†æˆ‘ä»¬è¦æ“ä½œçš„åˆ—;<code>.sum()</code> åˆ™æ˜¯æˆ‘ä»¬&quot;åº”ç”¨&quot;çš„èšåˆå‡½æ•°,è®¡ç®—æ¯ç»„çš„æ€»å’Œã€‚</p>
<p><code>groupby()</code> çš„ä¸€ä¸ªå¼ºå¤§ä¹‹å¤„åœ¨äº,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>.agg()</code> æ–¹æ³•ä¸€æ¬¡æ€§åº”ç”¨å¤šç§èšåˆå‡½æ•°ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ›´å…¨é¢çš„åˆ†ææŠ¥å‘Šã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># å¯¹æ¯ä¸ªç±»åˆ«åº”ç”¨å¤šç§èšåˆ</span>
category_summary = full_df.groupby(<span class="hljs-string">'category'</span>).agg(
    total_sales=(<span class="hljs-string">'final_sales'</span>, <span class="hljs-string">'sum'</span>),
    average_sale=(<span class="hljs-string">'final_sales'</span>, <span class="hljs-string">'mean'</span>),
    number_of_transactions=(<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'count'</span>),
    average_discount=(<span class="hljs-string">'discount'</span>, <span class="hljs-string">'mean'</span>),
    max_single_sale=(<span class="hljs-string">'final_sales'</span>, <span class="hljs-string">'max'</span>)
).round(<span class="hljs-number">2</span>)

<span class="hljs-comment"># æŒ‰æ€»é”€å”®é¢æ’åº</span>
category_summary = category_summary.sort_values(by=<span class="hljs-string">'total_sales'</span>, ascending=<span class="hljs-literal">False</span>)

print(<span class="hljs-string">"\nå®Œæ•´çš„ç±»åˆ«åˆ†ææŠ¥å‘Š:"</span>)
print(category_summary)
</div></code></pre>
<p>è¿™ç§&quot;å‘½åèšåˆ&quot;çš„è¯­æ³•éå¸¸æ¸…æ™°æ˜“è¯»,æ˜¯ç°ä»£Pandasçš„æœ€ä½³å®è·µã€‚ç°åœ¨,æˆ‘ä»¬ä¸ä»…å›ç­”äº†è€æ¿çš„é—®é¢˜,è¿˜æä¾›äº†æ›´ä¸°å¯Œçš„æ´å¯Ÿ:æ¯ä¸ªç±»åˆ«çš„å¹³å‡è®¢å•é‡‘é¢ã€äº¤æ˜“æ¬¡æ•°ã€å¹³å‡æŠ˜æ‰£ç‡,ç”šè‡³æœ€é«˜å•ç¬”äº¤æ˜“ã€‚</p>
<p>è®©æˆ‘ä»¬å†åšä¸€ä¸ªæœ‰è¶£çš„åˆ†æ:çœ‹çœ‹ä¸åŒè®¢å•çŠ¶æ€çš„é”€å”®åˆ†å¸ƒã€‚</p>
<pre class="hljs"><code><div><span class="hljs-comment"># åˆ†æä¸åŒçŠ¶æ€è®¢å•çš„æƒ…å†µ(ä½¿ç”¨å®Œæ•´æ•°æ®é›†,ä¸ä»…ä»…æ˜¯æ¬§æ´²)</span>
status_analysis = sales_df.groupby(<span class="hljs-string">'status'</span>).agg(
    transaction_count=(<span class="hljs-string">'transaction_id'</span>, <span class="hljs-string">'count'</span>),
    total_revenue=(<span class="hljs-string">'final_sales'</span>, <span class="hljs-string">'sum'</span>),
    avg_order_value=(<span class="hljs-string">'final_sales'</span>, <span class="hljs-string">'mean'</span>)
).round(<span class="hljs-number">2</span>)

print(<span class="hljs-string">"\nè®¢å•çŠ¶æ€åˆ†æ:"</span>)
print(status_analysis)

<span class="hljs-comment"># è®¡ç®—æœ‰æ•ˆè®¢å•çš„æ¯”ä¾‹</span>
total_transactions = len(sales_df)
valid_transactions = len(sales_df[sales_df[<span class="hljs-string">'status'</span>].isin([<span class="hljs-string">'Shipped'</span>, <span class="hljs-string">'Pending'</span>])])
print(<span class="hljs-string">f"\næœ‰æ•ˆè®¢å•æ¯”ä¾‹: <span class="hljs-subst">{valid_transactions/total_transactions*<span class="hljs-number">100</span>:<span class="hljs-number">.1</span>f}</span>%"</span>)

<span class="hljs-comment"># è®¡ç®—å› é€€è´§å’Œå–æ¶ˆè€ŒæŸå¤±çš„æ½œåœ¨æ”¶å…¥</span>
lost_revenue = sales_df[sales_df[<span class="hljs-string">'status'</span>].isin([<span class="hljs-string">'Returned'</span>, <span class="hljs-string">'Cancelled'</span>])][<span class="hljs-string">'final_sales'</span>].sum()
print(<span class="hljs-string">f"å› é€€è´§å’Œå–æ¶ˆæŸå¤±çš„æ”¶å…¥: $<span class="hljs-subst">{lost_revenue:,<span class="hljs-number">.2</span>f}</span>"</span>)
</div></code></pre>
<hr>
<h2 id="%E7%AC%AC%E4%B9%9D%E8%8A%82%E6%80%BB%E7%BB%93%E4%B8%8E%E5%AE%9E%E8%B7%B5%E6%8C%91%E6%88%98"><strong>ç¬¬ä¹èŠ‚:æ€»ç»“ä¸å®è·µæŒ‘æˆ˜</strong></h2>
<p><strong>(45:30 - 47:00)</strong></p>
<p>æˆ‘ä»¬æˆåŠŸäº†!è®©æˆ‘å›é¡¾ä¸€ä¸‹æˆ‘ä»¬çš„å®Œæ•´æ—…ç¨‹ã€‚æˆ‘ä»¬ä»ä¸‰ä¸ªæ··ä¹±ã€åˆ†æ•£çš„æ–‡ä»¶å¼€å§‹,è¿™äº›æ–‡ä»¶åŒ…å«ç¼ºå¤±å€¼ã€æ ¼å¼ä¸ä¸€è‡´,ç”šè‡³è¿æ ¸å¿ƒçš„é”€å”®é¢å­—æ®µéƒ½ä¸å­˜åœ¨ã€‚é€šè¿‡éµå¾ªä¸“ä¸šçš„æ•°æ®åˆ†ææµç¨‹,æˆ‘ä»¬å®Œæˆäº†å…«ä¸ªå…³é”®æ­¥éª¤:</p>
<ol>
<li><strong>åŠ è½½æ•°æ®</strong> - ä»CSVã€Excelå’ŒJSONä¸‰ç§æ ¼å¼å¯¼å…¥</li>
<li><strong>æ£€è§†æ•°æ®</strong> - ä½¿ç”¨.head()ã€.info()å’Œ.describe()äº†è§£æ•°æ®ç»“æ„</li>
<li><strong>æ¸…æ´—æ•°æ®</strong> - å¯¹æ¯”dropna()å’Œfillna(),ä½¿ç”¨å¤šç§å¡«å……ç­–ç•¥(0ã€&quot;Unknown&quot;ã€å¹³å‡å€¼ã€ä¸­ä½æ•°)</li>
<li><strong>ç‰¹å¾å·¥ç¨‹</strong> - è®¡ç®—final_sales = quantity Ã— list_price Ã— (1 - discount)</li>
<li><strong>ç­›é€‰æ•°æ®</strong> - åªä¿ç•™æ¬§æ´²åœ°åŒºçš„æœ‰æ•ˆè®¢å•</li>
<li><strong>æ’åºæ•°æ®</strong> - æŒæ¡sort_values()å’Œsort_index()çš„åŒºåˆ«</li>
<li><strong>åˆå¹¶æ•°æ®</strong> - å°†ä¸‰ä¸ªè¡¨è¿æ¥æˆç»Ÿä¸€æ•°æ®é›†</li>
<li><strong>åˆ†ç»„èšåˆ</strong> - æŒ‰ç±»åˆ«åˆ†æ,å¾—å‡ºæœ€ç»ˆç­”æ¡ˆ</li>
</ol>
<p>è¿™ä¸ªæµç¨‹,å°±æ˜¯æ•°æ®åˆ†æå¸ˆä½¿ç”¨Pandasè§£å†³é—®é¢˜çš„é€šç”¨å·¥ä½œæµã€‚</p>
<p>æˆ‘æƒ³ç‰¹åˆ«å¼ºè°ƒä»Šå¤©è¯¾ç¨‹ä¸­çš„å‡ ä¸ªå…³é”®è¦ç‚¹:</p>
<p><strong>ç¬¬ä¸€</strong>,ç¼ºå¤±å€¼å¤„ç†æ˜¯ä¸€é—¨è‰ºæœ¯,ä¸æ˜¯ç§‘å­¦ã€‚<code>dropna()</code> ç®€å•ä½†å±é™©,å¯èƒ½ä¼šä¸¢å¤±å¤§é‡æ•°æ®ã€‚<code>fillna()</code> æ›´çµæ´»,ä½†éœ€è¦æ ¹æ®ä¸šåŠ¡é€»è¾‘é€‰æ‹©æ­£ç¡®çš„å¡«å……ç­–ç•¥ã€‚</p>
<p><strong>ç¬¬äºŒ</strong>,æ’åºçœ‹ä¼¼ç®€å•,ä½†è¦ç†è§£ <code>sort_values()</code> å’Œ <code>sort_index()</code> çš„åŒºåˆ«ã€‚å‰è€…æŒ‰æ•°æ®å€¼æ’åºç”¨äºåˆ†æ,åè€…æŒ‰ç´¢å¼•æ ‡ç­¾æ’åºç”¨äºæ¢å¤é¡ºåºã€‚</p>
<p><strong>ç¬¬ä¸‰</strong>,ç‰¹å¾å·¥ç¨‹æ˜¯æ•°æ®åˆ†æçš„æ ¸å¿ƒæŠ€èƒ½ã€‚çœŸå®ä¸–ç•Œçš„æ•°æ®å¾€å¾€ä¸ä¼šç›´æ¥ç»™ä½ æƒ³è¦çš„æŒ‡æ ‡,ä½ éœ€è¦è‡ªå·±åˆ›é€ ã€‚</p>
<p><strong>ç¬¬å››</strong>,åˆ†ç»„èšåˆæ˜¯å›ç­”å•†ä¸šé—®é¢˜çš„åˆ©å™¨ã€‚æŒæ¡äº†groupby()å’Œagg(),ä½ å°±èƒ½å›ç­”å‡ ä¹æ‰€æœ‰&quot;å“ªä¸ª...æœ€...&quot;ç±»å‹çš„é—®é¢˜ã€‚</p>
<hr>
<h2 id="%E8%A7%86%E9%A2%91%E7%BB%93%E5%B0%BE"><strong>è§†é¢‘ç»“å°¾</strong></h2>
<p><strong>(47:00 - 47:30)</strong></p>
<p>æ„Ÿè°¢æ‚¨çš„è§‚çœ‹ã€‚å¸Œæœ›æœ¬è¯¾ç¨‹å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚è¯·åŠ¡å¿…å®Œæˆå®è·µæ´»åŠ¨,å› ä¸ºäº²è‡ªåŠ¨æ‰‹æ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹å¼ã€‚æ•°æ®åˆ†æä¸æ˜¯ç†è®ºè¯¾,è€Œæ˜¯ä¸€é—¨éœ€è¦å¤§é‡å®è·µçš„æŠ€èƒ½ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜,è¯·éšæ—¶è”ç³»æˆ‘ã€‚è®°ä½,æ¯ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®åˆ†æå¸ˆéƒ½æ˜¯ä»æ¸…æ´—ç¬¬ä¸€ä¸ªCSVæ–‡ä»¶å¼€å§‹çš„ã€‚ç»§ç»­åŠ æ²¹,ä¸‹æ¬¡å†è§!</p>

</body>
</html>
